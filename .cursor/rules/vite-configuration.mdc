---
description:
globs:
alwaysApply: false
---
# Vite Configuration Patterns

All extensions use similar Vite configurations with extension-specific customization. This configuration works with the entry points (see [entry-points.mdc](mdc:.cursor/rules/entry-points.mdc)) and build process (see [build-and-deployment.mdc](mdc:.cursor/rules/build-and-deployment.mdc)).

## Standard Vite Config Pattern
```javascript
const outDir = path.resolve(__dirname, '../../dist', 'extension-name')

export default defineConfig({
  base: '/extension-name/',
  plugins: [vue(), copyManifestPlugin],
  build: {
    lib: {
      entry: {
        'extension-name': fileURLToPath(new URL('./src/extension-name.ts', import.meta.url)),
      },
      formats: ['es'],
      fileName: (format, entryName) => `${entryName}.es.js`,
    },
    outDir,
  }
})
```

## Examples
- [src/auth-button/vite.config.js](mdc:src/auth-button/vite.config.js) - Uses main.js entry point
- [src/macro-tracker/vite.config.js](mdc:src/macro-tracker/vite.config.js) - Standard pattern
- [src/pushups/vite.config.js](mdc:src/pushups/vite.config.js) - Standard pattern
- [src/reviews/vite.config.js](mdc:src/reviews/vite.config.js) - Standard pattern
- [src/votes/vite.config.js](mdc:src/votes/vite.config.js) - Multiple entry points

## Key Configuration Elements
- **Base path**: Must match extension name (`/extension-name/`)
- **Output directory**: `../../dist/extension-name`
- **Entry points**: Must match actual .ts files in src/ (see [entry-points.mdc](mdc:.cursor/rules/entry-points.mdc))
- **Manifest copy**: Automatically copies manifest.json to output (see [manifest-patterns.mdc](mdc:.cursor/rules/manifest-patterns.mdc))
- **HTTPS support**: Uses localhost certificates for development

## Integration with Other Components
- **Entry Points**: Config entries must match [entry-points.mdc](mdc:.cursor/rules/entry-points.mdc) files
- **Manifest**: Base path should match [manifest-patterns.mdc](mdc:.cursor/rules/manifest-patterns.mdc) extension name
- **Build Process**: Output directory used by [build-and-deployment.mdc](mdc:.cursor/rules/build-and-deployment.mdc)
- **Structure**: Follows patterns in [extensions-structure.mdc](mdc:.cursor/rules/extensions-structure.mdc)

## Common Issues (see [common-issues.mdc](mdc:.cursor/rules/common-issues.mdc) for detailed solutions)
- Entry point file must exist in src/ directory
- Extension name in base path must match folder name
- Output directory must use extension name
- All extensions use port 5173 for development server

## When Working With Vite Configs
- **Creating new extension**: Follow the standard pattern above
- **Debugging build issues**: Check [common-issues.mdc](mdc:.cursor/rules/common-issues.mdc) for vite problems
- **Entry point changes**: Update both config and [entry-points.mdc](mdc:.cursor/rules/entry-points.mdc) files
- **Build process**: Coordinate with [build-and-deployment.mdc](mdc:.cursor/rules/build-and-deployment.mdc) scripts
